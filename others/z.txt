Q4. [10] A large reservoir of water serves several users. In order to keep the level of water sufficiently high, three sensors are placed vertically at 5-inch intervals. When the water level is above the highest sensor (S3), the input flow rate should be zero. When the level is below the lowest sensor (S1), the flow rate should be at maximum (both Nominal flow valve and Supplemental flow valve opened). The flow rate when the level is between the upper and lower sensors is determined by two factors: the water level and the level previous to the last sensor change. Each water level has a nominal flow rate associated with it, as shown in the table below. If the sensor change indicates that the previous level was lower than the current level, the nominal flow rate should take place. If the previous level was higher than the current level, the flow rate should be increased by opening the Supplemental flow valve (controlled by AFR). Draw the Moore model state diagram for the water reservoir controller. Clearly indicate all state transitions and outputs for each state. The inputs to your FSM are S1, S2 and S3; the outputs are FR1, FR2, FR3 and AFR.
Sensor Arrangement
FR3
S3
Nominal flow
FR2
S3
S2
rate controller
Water
FR1
Water Level
S1
reservoir
S2
controller
A FR
S1
Water Level
Sensors Asserted
-X
Supplemental flow rate
controller
-X
Nominal Flow Rate Inputs to Be Asserted
None
FR1
FR1, FR2
Above S3
S1, S2, S3
Between S3 and S2
S1, S2
Between S2 and S1
S1
Below S1
None
FR1, FR2, FR3


explain how to do this question
ChatGPT said:

To answer this question, you need to design a Moore Finite State Machine (FSM) for a water reservoir controller. The FSM will monitor sensor inputs (S1, S2, S3) and control the flow rate outputs (FR1, FR2, FR3, AFR) based on the current water level and the direction of change (i.e., whether the water level is rising or falling).

🔧 Step-by-Step Guide to Solve:
✅ Step 1: Understand the Inputs and Outputs
🟢 Inputs (from water level sensors):

Each sensor outputs 1 if submerged (active) and 0 if not submerged (inactive):

S1: Lowest sensor

S2: Middle sensor

S3: Highest sensor

So the combination of (S1, S2, S3) tells you how high the water level is.

🔴 Outputs (flow control valves):

FR1: Always ON when water level is below S3

FR2: ON when water is below S2

FR3: ON when water is below S1 (i.e., lowest)

AFR: Supplemental flow – ON only when water is falling

✅ Step 2: Define Water Level Zones

From the sensor arrangement, you can derive 4 water level zones:

Water Level Zone	Sensors (S1, S2, S3)	Description	Output (Nominal)
Above S3	1 1 1	All sensors submerged	No flow (FR1=FR2=FR3=0)
Between S3 and S2	1 1 0	S1 and S2 on	FR1 only
Between S2 and S1	1 0 0	S1 only	FR1 and FR2
Below S1	0 0 0	No sensors on	FR1, FR2, FR3
✅ Step 3: Understand Moore FSM

In a Moore machine, the output is only based on the current state, not the input.

So, for each state:

The state represents a combination of current water level and whether water was rising or falling.

Transitions occur based on sensor input (current water level).

Output (FR1, FR2, FR3, AFR) is fixed per state.

✅ Step 4: Determine FSM States

Since flow also depends on direction of change (rising or falling), each water level must have 2 states:

One for rising water

One for falling water

So we’ll have 8 states in total:

State Name	Level Zone	Direction	Outputs
A	Above S3	Rising	All OFF
B	Between S3 and S2	Rising	FR1
C	Between S2 and S1	Rising	FR1, FR2
D	Below S1	Rising	FR1, FR2, FR3
E	Above S3	Falling	All OFF
F	Between S3 and S2	Falling	FR1, AFR
G	Between S2 and S1	Falling	FR1, FR2, AFR
H	Below S1	Falling	FR1, FR2, FR3, AFR
✅ Step 5: Draw Transitions Between States

Transitions occur when sensor inputs change, i.e., when water level rises or falls to another zone.

Here’s a rough example of transitions:

From A:

Water falls → go to F (Between S3 and S2, Falling)

From B:

Water rises → go to A

Water falls → go to G

From C:

Water rises → go to B

Water falls → go to H

From D:

Water rises → go to C

From E:

Water falls → go to F

From F:

Water rises → go to E

Water falls → go to G

From G:

Water rises → go to F

Water falls → go to H

From H:

Water rises → go to G

The key is:

If current water level > previous level, direction is rising ⇒ move to rising state

If current < previous, direction is falling ⇒ move to falling state

✅ Step 6: Draw the Moore FSM Diagram

Each state:

Circle with state name

Label with output (FR1, FR2, etc.)

Arrows for transitions, labeled with input (S1, S2, S3 combination)

You’ll need 8 states: A through H
Each transition is labeled with the new sensor input (e.g., S1=1 S2=1 S3=0 for Between S3 and S2)

📝 Summary of What to Do

List all 8 states (rising/falling × 4 levels)

Define outputs for each state (based on flow rate table and whether AFR is needed)

Draw transition arrows between states (based on how sensor input changes)

Make sure you’re always transitioning based on sensor inputs but assigning outputs only in states (Moore model)

Label each state with its output (FR1, FR2, FR3, AFR)

If you'd like, I can draw the full FSM diagram for you. Would you like that?

You said:
yes
ChatGPT said:

To access the FSM diagram in ChatGPT canvas, you'll need to log in to ChatGPT. Once you're logged in, I can generate and display the full state diagram there.

Alternatively, I can describe it in text or generate an image here. How would you like to proceed?